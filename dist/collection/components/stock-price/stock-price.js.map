{"version":3,"file":"stock-price.js","sourceRoot":"","sources":["../../../src/components/stock-price/stock-price.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, State, h, Element, Prop, Watch, Listen } from '@stencil/core';\nimport { API_KEY } from '../../global/global';\n\n@Component({\n  tag: 'stock-price',\n  styleUrl: 'stock-price.css',\n  shadow: true,\n})\nexport class StockPrice {\n  stockInput: HTMLInputElement\n\n  @Element() el:HTMLElement\n\n  @State() fetchPrice: number\n  @State() stockUserInput: string\n  @State() stockInputValid = false\n  @State() error: string\n  @State() loading = false\n\n  @Prop({mutable: true, reflect: true}) stockSymbol: string\n\n  @Watch(\"stockSymbol\")\n  stockSymbolChanged(newValue: string, oldValue: string) {\n    if(newValue !== oldValue){\n      this.stockUserInput = newValue\n      this.stockInputValid = true\n      this.fetchStockPrice(newValue)\n    }\n  }\n\n  onUserInput(event: Event) {\n    this.stockUserInput = (event.target as HTMLInputElement).value\n    if(this.stockUserInput.trim() !== \"\"){\n      this.stockInputValid = true\n    } else {\n      this.stockInputValid = false\n    }\n  }\n\n  onFetchStockPrice(event: Event) {\n    event.preventDefault()\n    this.stockSymbol = this.stockInput.value\n  }\n\n  componentDidLoad() {\n    if(this.stockSymbol){\n      this.stockUserInput = this.stockSymbol\n      this.stockInputValid = true\n      this.fetchStockPrice(this.stockSymbol)\n    }\n  }\n\n  @Listen(\"ucSymbolSelected\", { target: 'body' })\n  onStockSymbolSelected(event: CustomEvent){\n    if(event.detail && event.detail !== this.stockSymbol){\n      this.stockSymbol = event.detail\n    }\n  }\n\n  test(){\n    this.loading = true\n  }\n\n  fetchStockPrice(stockSymbol: string){\n    this.loading = true\n    fetch(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${stockSymbol}&apikey=${API_KEY}`)\n      .then(res => {\n        return res.json()\n      })\n      .then(parseRes => {\n        if(!parseRes[\"Global Quote\"][\"05. price\"]){\n          throw new Error(\"Invalid symbol\")\n        }\n        this.error = null\n        this.fetchPrice = +parseRes[\"Global Quote\"][\"05. price\"]\n        console.log(parseRes)\n        this.loading = false\n      })\n      .catch(err => {\n        this.fetchPrice = null\n        this.error = err.message\n        this.loading = false\n      })\n  }\n\n  hostData() {\n    return {\n      class: this.error ? \"error\" : \"\"\n    }\n  }\n\n  render() {\n    let dataContent = <p>Please enter a symbol</p>\n    if(this.error) {\n      dataContent = <p>{this.error}</p>\n    }\n    if(this.fetchPrice) {\n      dataContent = <p>Price: ${this.fetchPrice}</p>\n    }\n    if(this.loading){\n      dataContent = (<div class=\"lds-ripple\"><div></div><div></div></div>)\n    }\n    return [\n      <form onSubmit={this.onFetchStockPrice.bind(this)}>\n        <input id=\"stock-symbol\" \n                ref={el => (this.stockInput = el)} \n                value={this.stockUserInput}\n                onInput={this.onUserInput.bind(this)}/>\n        <button type='submit' disabled={!this.stockInputValid || this.loading}>Fetch</button>\n      </form>,\n      <div>\n        {dataContent}\n      </div>\n    ]\n  }\n}\n"]}